var Client=function(e){var t={};t.config={test:!1,debug:!1,endpoint_path:"http://svr.digitwalk.com/gw/track"},t.token=e;var n=function(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)});return t},r=function(e){return(document.cookie.match("(^|; )"+e+"=([^;]*)")||0)[2]},o=r("_mh");o||(o=n(),document.cookie="_mh="+o),t.userIdentifier=o;var i=function(){return parseInt((new Date).getTime().toString().substring(0,10),10)};return t.send_request=function(e,n){var r=JSON.parse(JSON.stringify(e));t.config.test&&(r.test=1);var o=t.config.endpoint_path,i=function(e,t,n){var o=new XMLHttpRequest;o.onreadystatechange=function(){4==this.readyState&&(200==this.status?t(this.responseText):n(this.statusText))},o.open("POST",e,!0),o.setRequestHeader("Content-Type","text/plain"),o.send(JSON.stringify(r))};i(o,function(e){if(void 0!==n){var t="1"!=e?new Error("Maihoo Server Error"):void 0;n(t)}},function(e){t.config.debug&&console.log("Got Error: "+e.message),void 0!==n&&n(e)})},t.mergeObject=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},t.register=function(e){t.properties=t.properties||{},t.mergeObject(t.properties,e)},t.identify=function(e){t.userIdentifier=e},t.track=function(e,n,r){t.properties||(t.properties={}),n||(n={}),n.time=i();var o=JSON.parse(JSON.stringify(t.properties));t.mergeObject(o,n);var s={event:e,projectToken:t.token,properties:o};t.userIdentifier&&(s.userIdentifier=t.userIdentifier),t.config.debug&&(console.log("Sending the following event to Maihoo:"),console.log(s)),t.send_request(s,r)},t.track_links=function(e,n,r){var o=Array.prototype.slice.call(document.querySelectorAll(e),0);o.forEach(function(e){e.removeEventListener(),e.addEventListener("click",function(){t.track(n,r)})})},t.set_config=function(e){t.mergeObject(t.config,e)},t};