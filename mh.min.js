var Client=function(a){function c(a){return(document.cookie.match("(^|; )"+a+"=([^;]*)")||0)[2]}var b={};b.config={test:!1,debug:!1,endpoint_path:"http://api.digitwalk.com/gw/track"},b.token=a;var d=c("_mh");d||(d="",document.cookie="_mh="+d),b.userIdentifier=d;var e=function(){return parseInt((new Date).getTime().toString().substring(0,10),10)};return b.send_request=function(a,c){var d=JSON.parse(JSON.stringify(a));b.config.test&&(d.test=1);var e=b.config.endpoint_path,f=function(a,b,c){var e=new XMLHttpRequest;e.onreadystatechange=function(){4==this.readyState&&(200==this.status?b(this.responseText):c(this.statusText))},e.open("POST",a,!0),e.setRequestHeader("Content-Type","application/json"),e.send(JSON.stringify(d))};f(e,function(a){if(void 0!==c){var b="1"!=a?new Error("Maihoo Server Error"):void 0;c(b)}},function(a){b.config.debug&&console.log("Got Error: "+a.message),void 0!==c&&c(a)})},b.mergeObject=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},b.register=function(a){b.properties=b.properties||{},b.mergeObject(b.properties,a)},b.identify=function(a){b.userIdentifier=a},b.track=function(a,c,d){b.properties||(b.properties={}),c||(c={}),c.time=e();var f=JSON.parse(JSON.stringify(b.properties));b.mergeObject(f,c);var g={event:a,projectToken:b.token,properties:f};b.userIdentifier&&(g.userIdentifier=b.userIdentifier),b.config.debug&&(console.log("Sending the following event to Maihoo:"),console.log(g)),b.send_request(g,d)},b.set_config=function(a){b.mergeObject(b.config,a)},b};